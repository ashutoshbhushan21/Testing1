from bs4 import BeautifulSoup

def extract_html_content_advanced_v4(html, start_attrs, end_attrs):
    soup = BeautifulSoup(html, 'html.parser')

    start = soup.find(attrs=start_attrs)
    end = soup.find(attrs=end_attrs)

    if not start or not end:
        return "Start or end tag not found."

    def collect_content(current, end):
        content = [str(current)]  # Include the start tag
        parents = set([current])  # Keep track of parent elements
        current = current.next_element

        while current and current != end:
            # Check if current element is a direct child of an already included element
            if current.parent not in parents:
                content.append(str(current))
                parents.add(current)
            current = current.next_element
        return content

    collected_content = collect_content(start, end)
    return ''.join(collected_content)

# Example use
html_example_complex = '''...'''  # Your HTML content
extract_html_content_advanced_v4(html_example_complex, {'id': 'start'}, {'id': 'end'})
